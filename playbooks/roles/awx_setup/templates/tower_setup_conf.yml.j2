primary_machine: localhost
{% if admin_password is defined %}
admin_password: {{admin_password}}
{% endif %}
{% if rabbitmq_password is defined %}
rabbitmq_password: {{rabbitmq_password}}
{% endif %}
{% if munin_password is defined %}
munin_password: {{munin_password}}
{% endif %}
{% if redis_password is defined %}
redis_password: {{redis_password}}
{% endif %}

{% if 'tower_db' in hostvars['127.0.0.1'] %}
database: external
pg_database: {{hostvars['127.0.0.1']['tower_db']['pg_database']}}
pg_host: {{hostvars['127.0.0.1']['tower_db']['pg_host']}}
pg_port: {{hostvars['127.0.0.1']['tower_db']['pg_port']}}
pg_username: {{hostvars['127.0.0.1']['tower_db']['pg_username']}}
pg_password: {{hostvars['127.0.0.1']['tower_db']['pg_password']}}
{% else %}
database: internal
{% if pg_password is defined %}
pg_password: {{pg_password}}
{% endif %}
{% endif %}

{% if 'mongodb' in groups and groups['mongodb']|length > 0 %}
{% set mongo_host = groups['mongodb'][0] %}
mongo: true
mongo_database: {{ hostvars[mongo_host]['mongo_database'] }}
mongo_host: {{ mongo_host }}
mongo_port: {{ hostvars[mongo_host]['mongo_port'] }}
mongo_username: {{ hostvars[mongo_host]['mongo_username'] }}
mongo_password: {{ hostvars[mongo_host]['mongo_password'] }}
{% else %}
mongo: false
{% endif %}
